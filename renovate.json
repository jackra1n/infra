{
  "$schema": "https://docs.renovatebot.com/renovate-schema.json",
  "extends": [
    "config:recommended"
  ],
  "dependencyDashboard": true,
  "dependencyDashboardTitle": "Renovate Dashboard",
  "labels": [
    "renovate"
  ],
  "prHourlyLimit": 0,
  "configMigration": true,
  "separateMultipleMajor": true,
  "separateMinorPatch": true,
  "packageRules": [
    {
      "description": "Ignore Immich database and Redis images - managed manually",
      "matchPackageNames": [
        "docker.io/valkey/valkey",
        "ghcr.io/immich-app/postgres"
      ],
      "enabled": false
    },
    {
      "description": "Group Immich updates together",
      "matchPackageNames": [
        "ghcr.io/immich-app/immich-server",
        "ghcr.io/immich-app/immich-machine-learning"
      ],
      "groupName": "immich"
    },
    {
      "description": "Group Komodo updates together",
      "matchPackageNames": [
        "ghcr.io/moghtech/komodo-core",
        "ghcr.io/moghtech/komodo-periphery"
      ],
      "matchFileNames": [
        "docker/komodo/compose.yaml"
      ],
      "groupName": "komodo"
    },
    {
      "description": "Group Beszel updates together",
      "matchPackageNames": [
        "henrygd/beszel",
        "henrygd/beszel-agent"
      ],
      "matchFileNames": [
        "docker/beszel/compose.yaml"
      ],
      "groupName": "beszel"
    },
    {
      "description": "Separate PRs per stack directory for Docker Compose updates",
      "matchManagers": [
        "docker-compose"
      ],
      "additionalBranchPrefix": "{{parentDir}}-"
    },
    {
      "description": "Include stack name in commit messages for Docker stacks",
      "matchFileNames": [
        "docker/*/compose.yaml"
      ],
      "commitMessageTopic": "{{parentDir}} {{depName}} Docker tag"
    },
    {
      "description": "Handle hotio Docker tags like release-<version> and keep channel stable",
      "matchDatasources": [
        "docker"
      ],
      "versionCompatibility": "^(?<compatibility>release|testing)-v?(?<version>\\d+\\.\\d+\\.\\d+(?:\\.\\d+)?(?:-[\\w\\d.-]+)?)$",
      "versioning": "loose",
      "matchPackageNames": [
        "ghcr.io/hotio/{/,}**"
      ]
    },
    {
      "description": "Auto-merge patch updates for trusted packages",
      "matchPackageNames": [
        "renovatebot/github-action",
        "ghcr.io/dgtlmoon/changedetection.io",
        "ghcr.io/triliumnext/trilium",
        "henrygd/beszel",
        "henrygd/beszel-agent",
        "ghcr.io/paperless-ngx/paperless-ngx",
        "cloudflare/cloudflared",
        "ghcr.io/autobrr/qui",
        "ghcr.io/cross-seed/cross-seed",
        "ghcr.io/gethomepage/homepage",
        "lscr.io/linuxserver/syncthing"
      ],
      "matchUpdateTypes": [
        "patch"
      ],
      "automerge": true,
      "automergeType": "pr",
      "ignoreTests": true
    }
  ]
}
